<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.yedam.fandemic.impl.GoodsMapper">

	<!-- Goods 전체 목록 : 조회 -->
	<select id="goodsList" parameterType="Goods" resultType="Goods">
		SELECT *
		FROM (
		SELECT A.*, ROWNUM RNUM
		FROM (
		SELECT *
		FROM V_GOODS
		ORDER BY 1 DESC) A
		) B
		WHERE RNUM BETWEEN #{go_first} AND #{go_last}
	</select>

	<!-- Goods 전체 목록 : 카테고리별 -->
	<select id="goFilter" parameterType="Goods" resultType="Goods">
		SELECT *
		FROM (
		SELECT A.*, ROWNUM RNUM
		FROM (
		SELECT *
		FROM V_GOODS
		WHERE GO_TYPE = #{go_type}
		ORDER BY 1 DESC) A
		) B
		WHERE RNUM BETWEEN #{go_first} AND #{go_last}
	</select>

	<!-- Goods 전체 목록 : 페이징 -->
	<select id="goCount" resultType="int">
		SELECT COUNT(*) FROM V_GOODS
	</select>

	<!-- Goods 상세 조회 -->
	<select id="goodsDetail" parameterType="Goods" resultType="Goods">
		SELECT *
		FROM GOODS
		WHERE GO_NO = #{go_no}
	</select>

	<!-- 장바구니에 insert -->
	<!-- <insert id="cartInsert" useGeneratedKeys="true" parameterType="Cart"> 
		INSERT INTO CART ( CART_NO, MEM_ID, GO_NO, CART_QTY ) VALUES ( CART_SEQ.NEXTVAL, 
		#{mem_id}, #{go_no], #{cart_qty} ) </insert> -->

	<!-- 장바구니 목록 -->
	<select id="cartList" parameterType="Cart" resultType="Cart">
		SELECT C.*, G.GO_NAME, G.GO_PRICE, M.MEM_NAME
		FROM GOODS G, CART C, MEMBER M
		WHERE G.GO_NO = C.GO_NO AND C.MEM_ID = M.MEM_ID AND C.MEM_ID = #{mem_id}
	</select>

</mapper>
